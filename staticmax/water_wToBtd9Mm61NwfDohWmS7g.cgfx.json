{"version": 1,"name": "water.cgfx","samplers":{"shadowMapTexture":{"MinFilter": 9729,"MagFilter": 9729,"WrapS": 33071,"WrapT": 33071},"noiseTexture":{"MinFilter": 9985,"MagFilter": 9729,"WrapS": 10497,"WrapT": 10497,"MaxAnisotropy": 4},"energytrailTexture":{"MinFilter": 9985,"MagFilter": 9729,"WrapS": 33071,"WrapT": 10497}},"parameters":{"viewShadowProjection0":{"type": "float","rows": 3,"columns": 4},"shadowOffset0":{"type": "float","columns": 2},"viewShadowProjection1":{"type": "float","rows": 3,"columns": 4},"shadowOffset1":{"type": "float","columns": 2},"viewShadowProjection2":{"type": "float","rows": 3,"columns": 4},"shadowOffset2":{"type": "float","columns": 2},"viewShadowProjection3":{"type": "float","rows": 3,"columns": 4},"shadowOffset3":{"type": "float","columns": 2},"invShadowSize":{"type": "float"},"shadowMapTexture":{"type": "sampler2D"},"projection":{"type": "float","rows": 4,"columns": 4},"worldView":{"type": "float","rows": 4,"columns": 3},"worldViewInverseTranspose":{"type": "float","rows": 3,"columns": 3},"fogColor":{"type": "float","columns": 3},"invCameraFar":{"type": "float"},"waterColorBright":{"type": "float","columns": 3,"values": [0.251,0.878,0.515]},"waterColorDark":{"type": "float","columns": 3,"values": [0.1,0.3,0.4]},"waterGain":{"type": "float","values": [0.7]},"waterSpecularPower":{"type": "float","values": [2]},"waterSpecularScale":{"type": "float","values": [0.8]},"glowColor":{"type": "float","columns": 3,"values": [0,1,1]},"trailColor":{"type": "float","columns": 3},"noiseTexture":{"type": "sampler2D"},"energytrailTexture":{"type": "sampler2D"}},"techniques":{"water":[{"parameters": ["projection","worldView","viewShadowProjection0","shadowOffset0","viewShadowProjection1","shadowOffset1","viewShadowProjection2","shadowOffset2","viewShadowProjection3","shadowOffset3","invShadowSize","shadowMapTexture","worldViewInverseTranspose","fogColor","invCameraFar","waterColorBright","waterColorDark","waterGain","waterSpecularPower","waterSpecularScale","glowColor","trailColor","noiseTexture","energytrailTexture"],"semantics": ["ATTR0","ATTR8","ATTR9","ATTR10"],"states":{"DepthTestEnable": true,"DepthFunc": 515,"DepthMask": true,"CullFaceEnable": false,"BlendEnable": false},"programs": ["vp","fp"]}]},"programs":{"fp":{"type": "fragment","code": "#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[4];\nvec4 _ret_0;float _TMP10;vec4 _TMP9;vec4 _TMP28;float _TMP31;float _TMP29;float _TMP27;float _TMP25;float _TMP30;float _TMP24;float _TMP23;float _TMP22;float _TMP21;float _TMP20;float _TMP19;float _TMP18;float _TMP17;float _TMP8;float _TMP7;float _TMP5;float _TMP16;float _TMP15;float _TMP14;float _TMP4;float _TMP3;float _TMP2;float _TMP1;vec4 _TMP13;vec4 _TMP12;vec4 _TMP11;float _TMP0;float _x0060;float _TMP61;float _noise10068;float _noise20068;float _noise30068;vec2 _pos10076;float _noise10076;vec2 _pos20076;float _noise20076;vec2 _pos30076;float _noise30076;vec2 _pos10084;float _noise10084;vec2 _pos20084;float _noise20084;vec2 _pos30084;float _noise30084;vec2 _pos10092;float _noise10092;vec2 _pos20092;float _noise20092;vec2 _pos30092;float _noise30092;vec2 _pos10100;float _noise10100;vec2 _pos20100;float _noise20100;vec2 _pos30100;float _noise30100;float _TMP123;float _a0134;float _t0134;float _TMP135;vec4 _viewPositionH0136;float _shadowSpaceLimit0136;float _shadowSpaceX0136;float _shadowSpaceY0136;vec4 _shadowDepth0136;vec2 _shadowOffset0136;vec2 _shadowuv0136;bool _TMP137;float _TMP178;float _TMP188;float _TMP194;float _t0203;uniform vec4 viewShadowProjection0[3];uniform vec2 shadowOffset0;uniform vec4 viewShadowProjection1[3];uniform vec2 shadowOffset1;uniform vec4 viewShadowProjection2[3];uniform vec2 shadowOffset2;uniform vec4 viewShadowProjection3[3];uniform vec2 shadowOffset3;uniform float invShadowSize;uniform sampler2D shadowMapTexture;uniform vec3 worldViewInverseTranspose[3];uniform vec3 fogColor;uniform float invCameraFar;uniform vec3 waterColorBright;uniform vec3 waterColorDark;uniform float waterGain;uniform float waterSpecularPower;uniform float waterSpecularScale;uniform vec3 glowColor;uniform vec3 trailColor;uniform sampler2D noiseTexture;uniform sampler2D energytrailTexture;void main()\n{float _waterHeight;vec3 _normal;vec3 _waterPosition;vec3 _r;float _s;float _d;vec3 _backColor;vec2 _energytrailUV;_x0060=-tz_TexCoord[3].z*invCameraFar;_TMP29=min(1.0,_x0060);_TMP61=max(0.0,_TMP29);_TMP11=texture2D(noiseTexture,tz_TexCoord[0].xy);_noise10068=2.0*_TMP11.x-1.0;_TMP12=texture2D(noiseTexture,tz_TexCoord[1].xy);_noise20068=2.0*_TMP12.x-1.0;_TMP13=texture2D(noiseTexture,tz_TexCoord[2].xy);_noise30068=2.0*_TMP13.x-1.0;_TMP0=waterGain*_noise10068+waterGain*waterGain*_noise20068+waterGain*waterGain*waterGain*_noise30068;_waterHeight=0.5*_TMP0+0.5;_pos10076=tz_TexCoord[0].xy+vec2(-9.76562500E-04,0.0);_pos20076=tz_TexCoord[1].xy+vec2(-9.76562500E-04,0.0);_pos30076=tz_TexCoord[2].xy+vec2(-9.76562500E-04,0.0);_TMP11=texture2D(noiseTexture,_pos10076);_noise10076=2.0*_TMP11.x-1.0;_TMP12=texture2D(noiseTexture,_pos20076);_noise20076=2.0*_TMP12.x-1.0;_TMP13=texture2D(noiseTexture,_pos30076);_noise30076=2.0*_TMP13.x-1.0;_TMP1=waterGain*_noise10076+waterGain*waterGain*_noise20076+waterGain*waterGain*waterGain*_noise30076;_pos10084=tz_TexCoord[0].xy+vec2(9.76562500E-04,0.0);_pos20084=tz_TexCoord[1].xy+vec2(9.76562500E-04,0.0);_pos30084=tz_TexCoord[2].xy+vec2(9.76562500E-04,0.0);_TMP11=texture2D(noiseTexture,_pos10084);_noise10084=2.0*_TMP11.x-1.0;_TMP12=texture2D(noiseTexture,_pos20084);_noise20084=2.0*_TMP12.x-1.0;_TMP13=texture2D(noiseTexture,_pos30084);_noise30084=2.0*_TMP13.x-1.0;_TMP2=waterGain*_noise10084+waterGain*waterGain*_noise20084+waterGain*waterGain*waterGain*_noise30084;_pos10092=tz_TexCoord[0].xy+vec2(0.0,-9.76562500E-04);_pos20092=tz_TexCoord[1].xy+vec2(0.0,-9.76562500E-04);_pos30092=tz_TexCoord[2].xy+vec2(0.0,-9.76562500E-04);_TMP11=texture2D(noiseTexture,_pos10092);_noise10092=2.0*_TMP11.x-1.0;_TMP12=texture2D(noiseTexture,_pos20092);_noise20092=2.0*_TMP12.x-1.0;_TMP13=texture2D(noiseTexture,_pos30092);_noise30092=2.0*_TMP13.x-1.0;_TMP3=waterGain*_noise10092+waterGain*waterGain*_noise20092+waterGain*waterGain*waterGain*_noise30092;_pos10100=tz_TexCoord[0].xy+vec2(0.0,9.76562500E-04);_pos20100=tz_TexCoord[1].xy+vec2(0.0,9.76562500E-04);_pos30100=tz_TexCoord[2].xy+vec2(0.0,9.76562500E-04);_TMP11=texture2D(noiseTexture,_pos10100);_noise10100=2.0*_TMP11.x-1.0;_TMP12=texture2D(noiseTexture,_pos20100);_noise20100=2.0*_TMP12.x-1.0;_TMP13=texture2D(noiseTexture,_pos30100);_noise30100=2.0*_TMP13.x-1.0;_TMP4=waterGain*_noise10100+waterGain*waterGain*_noise20100+waterGain*waterGain*waterGain*_noise30100;_normal=vec3(_TMP1-_TMP2,1.00000001E-01,_TMP3-_TMP4);_TMP14=dot(_normal,_normal);_TMP15=inversesqrt(_TMP14);_normal=_TMP15*_normal;_normal=_normal.xxx*worldViewInverseTranspose[0]+_normal.yyy*worldViewInverseTranspose[1]+_normal.zzz*worldViewInverseTranspose[2];_waterPosition=tz_TexCoord[3].xyz+_normal*(2.0*_waterHeight-2.0);_TMP16=dot(_normal,vec3(0.0,-1.0,0.0));_r=vec3(0.0,-1.0,0.0)-(2.0*_normal)*_TMP16;_TMP5=dot(vec3(1.0,0.0,0.0),_r);_TMP29=min(1.0,_TMP5);_TMP123=max(0.0,_TMP29);_TMP7=pow(_TMP123,waterSpecularPower);_s=waterSpecularScale*_TMP7;_TMP8=dot(_normal,vec3(0.0,-1.0,0.0));_d=0.5*(-_TMP8+0.5);_a0134=_waterHeight*_d;_t0134=_TMP61*_TMP61;_d=_a0134+_t0134*(0.0-_a0134);_TMP137=true;_viewPositionH0136=vec4(_waterPosition.x,_waterPosition.y,_waterPosition.z,1.0);_shadowSpaceLimit0136=1.0-invShadowSize;_shadowSpaceX0136=dot(_viewPositionH0136,viewShadowProjection0[0]);_shadowSpaceY0136=dot(_viewPositionH0136,viewShadowProjection0[1]);_TMP17=abs(_shadowSpaceX0136);_TMP18=abs(_shadowSpaceY0136);if(_TMP17<_shadowSpaceLimit0136&&_TMP18<_shadowSpaceLimit0136){_shadowDepth0136=viewShadowProjection0[2];_shadowOffset0136=shadowOffset0;}else{_shadowSpaceX0136=dot(_viewPositionH0136,viewShadowProjection1[0]);_shadowSpaceY0136=dot(_viewPositionH0136,viewShadowProjection1[1]);_TMP19=abs(_shadowSpaceX0136);_TMP20=abs(_shadowSpaceY0136);if(_TMP19<_shadowSpaceLimit0136&&_TMP20<_shadowSpaceLimit0136){_shadowDepth0136=viewShadowProjection1[2];_shadowOffset0136=shadowOffset1;}else{_shadowSpaceX0136=dot(_viewPositionH0136,viewShadowProjection2[0]);_shadowSpaceY0136=dot(_viewPositionH0136,viewShadowProjection2[1]);_TMP21=abs(_shadowSpaceX0136);_TMP22=abs(_shadowSpaceY0136);if(_TMP21<_shadowSpaceLimit0136&&_TMP22<_shadowSpaceLimit0136){_shadowDepth0136=viewShadowProjection2[2];_shadowOffset0136=shadowOffset2;}else{_shadowSpaceX0136=dot(_viewPositionH0136,viewShadowProjection3[0]);_shadowSpaceY0136=dot(_viewPositionH0136,viewShadowProjection3[1]);_TMP23=abs(_shadowSpaceX0136);_TMP24=abs(_shadowSpaceY0136);if(_TMP23<_shadowSpaceLimit0136&&_TMP24<_shadowSpaceLimit0136){_shadowDepth0136=viewShadowProjection3[2];_shadowOffset0136=shadowOffset3;}else{_TMP135=1.0;_TMP137=false;}}}}\nif(_TMP137){_shadowuv0136=vec2(_shadowSpaceX0136,_shadowSpaceY0136)*2.50000000E-01+_shadowOffset0136.xy;_TMP25=dot(_viewPositionH0136,_shadowDepth0136);_TMP30=dot(vec3(1.0,1.0,1.0),vec3(1.51991844E-05,3.89099121E-03,9.96093750E-01));_TMP29=min(1.0,_TMP30);_TMP178=max(0.0,_TMP29);_TMP27=min(_TMP25,_TMP178);_TMP28=texture2D(shadowMapTexture,_shadowuv0136);if(_TMP28.w>3.92156886E-03){_TMP31=dot(_TMP28.xyz,vec3(1.51991844E-05,3.89099121E-03,9.96093750E-01));_TMP29=min(1.0,_TMP31);_TMP194=max(0.0,_TMP29);_TMP188=float((_TMP194>=_TMP27));}else{_TMP188=1.0;}\n_TMP135=_TMP188;}\n_s=_s*_TMP135;_d=_d-(2.00000003E-01-_TMP135*2.00000003E-01);_backColor=(_s+waterColorBright)*_d+waterColorDark;_energytrailUV=vec2(tz_TexCoord[0].y*6.00000024E-01+0.5,tz_TexCoord[0].x*5.00000007E-02);if(0.0<_energytrailUV.x&&_energytrailUV.x<1.0){_TMP9=texture2D(energytrailTexture,_energytrailUV);_t0203=_TMP9.y*8.00000012E-01;_backColor=_backColor+_t0203*(trailColor-_backColor);_TMP10=pow(_waterHeight,8.0);_backColor=_backColor+glowColor*_TMP10*_TMP9.y;}\n_backColor=_backColor+_TMP61*(fogColor-_backColor);_ret_0=vec4(_backColor.x,_backColor.y,_backColor.z,0.0);gl_FragColor=_ret_0;}"},"vp":{"type": "vertex","code": "#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[4];attribute vec4 ATTR0;attribute vec4 ATTR8;attribute vec4 ATTR9;attribute vec4 ATTR10;\nvec4 _OUTPosition1;vec2 _OUTUV11;vec3 _OUTViewPosition1;vec2 _OUTUV01;vec2 _OUTUV21;uniform vec4 projection[4];uniform vec3 worldView[4];void main()\n{vec3 _position;vec3 _viewPosition;_position=vec3(ATTR0.x,0.0,ATTR0.y);_viewPosition=_position.xxx*worldView[0]+_position.yyy*worldView[1]+_position.zzz*worldView[2]+worldView[3];_OUTPosition1=_viewPosition.xxxx*projection[0]+_viewPosition.yyyy*projection[1]+_viewPosition.zzzz*projection[2]+projection[3];_OUTUV01=ATTR8.xy;_OUTUV11=ATTR9.xy;_OUTUV21=ATTR10.xy;_OUTViewPosition1=_viewPosition;tz_TexCoord[2].xy=ATTR10.xy;tz_TexCoord[0].xy=ATTR8.xy;tz_TexCoord[3].xyz=_viewPosition;tz_TexCoord[1].xy=ATTR9.xy;gl_Position=_OUTPosition1;}"}}}